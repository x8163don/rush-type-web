<!DOCTYPE html><html><body><script type="module">const o=document.createElement("script");o.src="https://apis.google.com/js/api.js",o.async=!0,o.defer=!0,o.onload=()=>{r()},document.body.appendChild(o);const i="chrome-extension://mdiaogojdgljpfapolbgdlflobbagned",n="AIzaSyAaaWKF8wLm7OQMBnEAzRP3FI5UVmMCTM8",s="1090813013146";let a=null,t=null,c=!1,l=!1;function r(){gapi.load("client:picker",p)}async function p(){await gapi.client.load("https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"),c=!0,d()}function d(){c&&l&&console.log("Picker and GIS initialized. Buttons can be enabled.")}function g(){const e=new google.picker.DocsView(google.picker.ViewId.SPREADSHEETS).setMode(google.picker.DocsViewMode.LIST);e.setMimeTypes("spreadsheet/*,application/vnd.google-apps.spreadsheet"),(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setLocale(t||"en").setDeveloperKey(n).setAppId(s).setOAuthToken(a).addView(e).setOrigin(i).setCallback(k).build().setVisible(!0),window.parent.postMessage({action:"pickerLoaded"},i)}async function k(e){e.action===google.picker.Action.PICKED?window.parent.postMessage({action:"filesSelected",files:e[google.picker.Response.DOCUMENTS]},i):e.action===google.picker.Action.CANCEL&&window.parent.postMessage({action:"pickerCanceled"},i)}window.addEventListener("message",(async e=>{e.origin===i&&("configuration"===e.data.action&&(t=e.data.locale,a=e.data.accessToken,e.data.filesSelected),"createPicker"===e.data.action&&g())}),!1)</script></body></html>